# orders-evo.yaml
# Configuration for EVO order database as target

version: 1.0.0

target:
  type: sqlite
  name: EVO Orders
  description: SQLite database for EVO order synchronization

connection:
  database: ${ORDERS_DB_PATH}
  mode: readwrite

# Entity mappings to target tables
entities:
  orders:
    table: Orders
    primary_key: ID
    unique_key: XT_Order_ID
    fields:
      ID:
        type: integer
        auto_increment: true
      XT_Order_ID:
        type: integer
        required: true
      Customer_ID:
        type: integer
        nullable: true
      Status:
        type: integer
        nullable: true
      Date_Purchased:
        type: string
        nullable: true
      Last_Modified:
        type: string
        nullable: true
      Currency:
        type: string
        nullable: true
      Currency_Value:
        type: real
        nullable: true
      Total:
        type: real
        nullable: true
      Payment_Method:
        type: string
        nullable: true
      Shipping_Method:
        type: string
        nullable: true
      Customer_Name:
        type: string
        nullable: true
      Customer_Company:
        type: string
        nullable: true
      Customer_Address:
        type: string
        nullable: true
      Customer_Postcode:
        type: string
        nullable: true
      Customer_City:
        type: string
        nullable: true
      Customer_Country:
        type: string
        nullable: true
      Customer_Phone:
        type: string
        nullable: true
      Customer_Email:
        type: string
        nullable: true
      update:
        type: integer
        default: 0
        required: true
      last_imported_hash:
        type: string
        nullable: true
      last_seen_hash:
        type: string
        nullable: true

  order_products:
    table: Order_Products
    primary_key: ID
    fields:
      ID:
        type: integer
        auto_increment: true
      XT_Order_Product_ID:
        type: integer
        nullable: true
      Order_ID:
        type: integer
        required: true
      XT_Order_ID:
        type: integer
        nullable: true
      Product_ID:
        type: integer
        nullable: true
      Product_Model:
        type: string
        nullable: true
      Product_Name:
        type: string
        nullable: true
      Product_Price:
        type: real
        nullable: true
      Quantity:
        type: integer
        nullable: true
      Tax:
        type: real
        nullable: true
      update:
        type: integer
        default: 0
        required: true

# Delta tracking configuration
delta:
  enabled: true
  export_database: ${ORDERS_DELTA_DB_PATH}
  track_field: update
  export_on_complete: true

# Hash-based change detection configuration
hash_fields:
  orders:
    included:
      - Customer_ID
      - Status
      - Date_Purchased
      - Last_Modified
      - Currency
      - Currency_Value
      - Total
      - Payment_Method
      - Shipping_Method
      - Customer_Name
      - Customer_Company
      - Customer_Address
      - Customer_Postcode
      - Customer_City
      - Customer_Country
      - Customer_Phone
      - Customer_Email
