# source_afs.yml
# Configuration for AFS-ERP MSSQL source mapping

source:
  type: mssql
  name: AFS-ERP
  description: AFS-ERP MSSQL database as source system

connection:
  host: ${AFS_MSSQL_HOST}
  port: ${AFS_MSSQL_PORT}
  database: ${AFS_MSSQL_DB}
  username: ${AFS_MSSQL_USER}
  password: ${AFS_MSSQL_PASS}

# Entity mappings from AFS source
entities:
  articles:
    table: dbo.Artikel
    primary_key: ArtikelID
    fields:
      - name: ArtikelID
        type: integer
        required: true
      - name: Artikelnummer
        type: string
        required: true
      - name: Bezeichnung
        type: string
      - name: Preis
        type: decimal

  categories:
    table: dbo.Warengruppe
    primary_key: WarengruppenID
    fields:
      - name: WarengruppenID
        type: integer
        required: true
      - name: Warengruppenname
        type: string
        required: true
      - name: Parent
        type: integer

  images:
    table: dbo.Bilder
    primary_key: BildID
    fields:
      - name: BildID
        type: integer
        required: true
      - name: Dateiname
        type: string
        required: true
      - name: ArtikelID
        type: integer

  documents:
    table: dbo.Dokumente
    primary_key: DokumentID
    fields:
      - name: DokumentID
        type: integer
        required: true
      - name: Titel
        type: string
        required: true
      - name: ArtikelID
        type: integer

  attributes:
    table: dbo.Attribute
    primary_key: AttributID
    fields:
      - name: AttributID
        type: integer
        required: true
      - name: AttributName
        type: string
        required: true
      - name: Wert
        type: string

# Transformation rules
transformations:
  normalize_strings:
    - trim
    - remove_empty
    - deduplicate
  
  price_format:
    type: decimal
    precision: 2
    
  date_format:
    from: "Y-m-d H:i:s"
    to: "Y-m-d\TH:i:s\Z"
